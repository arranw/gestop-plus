// ==UserScript==
// @name         Themes
// @namespace    http://tampermonkey.net/
// @version      0.1
// @description  themes
// @author       You
// @match        https://home.aeromag2000.com/gestoplight/
// @grant        GM_addStyle
// @require      http://code.jquery.com/jquery-1.8.24.min.js
// @require      Common.js
// @require      DeicingVM.js
// @require      knockout-3.4.2.js
// @updateURL    https://raw.githubusercontent.com/arranw/gestop-plus/master/tm-plus.js
// ==/UserScript==

var themeTicker = document.createElement("input");
themeTicker.type = "checkbox";
changeTheme();
themeTicker.onclick = changeTheme;
document.body.appendChild(themeTicker);

var xmasLabel = document.createElement("label");
xmasLabel.innerHTML("Xmas");
document.body.parentNode.insertBefore(xmasLabel, xmasTicker);
xmasLabel.appendChild(xmasLabel);

var xmasTicker = document.createElement("input");
xmasTicker.type = "checkbox";
xmasTicker.onclick = changeTheme;
document.body.appendChild(xmasTicker);

function changeTheme() {
    var bgBlack = "#000";
    var themeBg;
    var themeFg;

    if (themeTicker.checked) {
        var black = "#000";
        var magBlue = "#33BBFF";
        var green = "#00FF3E";
        var darkGreen = "#00B32C";
        var red = "#Fd4a3e";
        var darkRed = "#B3000C";

        if (xmasTicker.checked) {
            themeBg = "{background-color: #fff !important}";
            themeFg = "{color: #000 !important}";
            //         document.getElementById("tdFlightsInColdStorage").classList.add("border1");
            document.getElementById("tdFlightsInProgress").classList.remove("border2");
            document.getElementById("tdFlightsInProgress").classList.add("border1");
            GM_addStyle("body, tr, th, tbody {border: 0px solid #fff !important}");
            GM_addStyle(".ui-state-default {background: #9399a0 !important}");
            GM_addStyle(".ui-state-default {color: #e0e0e0 !important}");
        } else {
            themeBg = "{background-color: " + black + " !important}";
            themeFg = "{color: " + magBlue + " !important}";

            findFirstDescendant("frmFlightStrip", "table").classList.remove("border1");
            findFirstDescendant("body", "table").classList.remove("border1");
            findFirstDescendant("ui-id-2", "td").classList.remove("border1");

            document.getElementById("ui-id-4").parentNode.parentNode.style.marginTop = "5px";

            document.getElementById("tdFlightsInColdStorage").classList.remove("border1");
            document.getElementById("tdFlightsInProgress").classList.remove("border1");
            document.getElementById("tdFlightsInProgress").classList.add("border2");
            //         GM_addStyle("table, fieldset{border: 3px solid " + darkRed + " !important}");
            GM_addStyle(".ui-state-default {background: #000 !important}");
            GM_addStyle(".ui-state-default {color: #ffffff !important}");
            GM_addStyle("fieldset {border: 0px !important}");
        }
    } else {
        themeBg = "{background-color: #fff !important}";
        themeFg = "{color: #000 !important}";
        //         document.getElementById("tdFlightsInColdStorage").classList.add("border1");
//         document.getElementById("tdFlightsInProgress").classList.remove("border1");
        document.getElementById("tdFlightsInProgress").classList.add("border2");
        GM_addStyle("body, tr, th, tbody {border: 0px solid #fff !important}");
        GM_addStyle(".ui-state-default {background: #9399a0 !important}");
        GM_addStyle(".ui-state-default {color: #e0e0e0 !important}");
    }

    GM_addStyle("body, html, footer, div, th, tr, td, section, select, input, textarea, li " + themeBg); // active flights
    GM_addStyle("body, html, h3, footer, div, th, tr, td, select, input, textarea, a " + themeFg);
}

function findFirstDescendant(parent, tagname) {
   parent = document.getElementById(parent);
   var descendants = parent.getElementsByTagName(tagname);
   if ( descendants.length ){
      return descendants[0];
   }
   return null;
}
